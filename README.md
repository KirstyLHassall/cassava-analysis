# cassava-analysis

Code associated with statistical anaysis for the article 
_Validating a cassava spatial disaggregation model in sub-Saharan Africa_ (In press) 
Kirsty L. Hassall, Hadewij Sint, Joe Helps, Phillip Abidrabo, Geoffrey Okao-Okuja, Roland G. Eboulem, William J-L. Amoakon, Daniel H. Otron, Vasthi Alonso Chávez, Anna M. Szyniszewska

_Abstract_: Cassava is a staple in the diet of millions of people in sub-Saharan Africa. As it can grow in poor soils with limited inputs and can withstand a wide range of environmental conditions including drought, it is an important food security crop in the region. Previous studies have shown that the distribution of rural populations is an important predictor of cassava density in sub-Saharan Africa's landscape.  Our aim is to explore relationships between the distribution of cassava from the cassava production disaggregation models (CassavaMap and MapSPAM) and rural population density, looking at potential differences between countries and regions. To achieve this, we analysed properties of cassava cultivations collected from surveys at 69 locations in Côte d’Ivoire and 96 locations in Uganda conducted between February and March 2018. The relationships between the proportion of surveyed land under cassava cultivation and rural population and settlement data were examined using a set of generalized additive models within each country. Information on rural settlements was aggregated around the survey locations at 2, 5 and 10 km circular buffers. The analysis of the original survey data showed no significant correlation between rural population and cassava production in both MapSPAM and CassavaMap. However, as we aggregate settlement buffers around the survey locations using CassavaMap, we find that at a large scale, this model does capture large-scale variations in cassava production. Moreover, through our analyses, we discovered country-specific spatial trends linked to areas of higher cassava production.

Original Survey data can be found at: Szyniszewska, Anna; Hassall, Kirsty L. (2023). Cassava field perimeters survey in Uganda and Côte d'Ivoire, 2018. figshare. Dataset. https://doi.org/10.6084/m9.figshare.23657391.v1

Processed Survey data can be found at: Hassall, Kirsty (2024). Processed Data for Cassava field perimeters survey in Uganda and Côte d'Ivoire, 2018. figshare. Dataset. https://doi.org/10.6084/m9.figshare.26983603.v1

**SurveyResults.R** contains the code for analysing the processed cassava survey data inlcuding calculating summary statistics of different cropping systems

**ModelVsSurvey_baseline.R** contains the code for comparing the observed cassava production vs modelled cassava production (from CassavaMap) at the point locations in Cote d'Ivoire and Uganda.
Baseline regression models were used to assess the association between observed cassava production and cassava production predicted from CassavaMap. 

**ModelVsSurvey.R** contains the code for comparing the observed cassava production vs modelled cassava production (from CassavaMap) across buffered locations in Cote d'Ivoire and Uganda incorporating population and settlement information.
To investigate the impact of the spatial resolution of cassava production and harvested area of CassavaMap predictions along with any potential biases associated with settlement and population density in the surveyed locations, a systematic regression framework was used for six response variables: total cassava density, total cassava density under monoculture, total cassava density under intercropping and their associated weighted versions. Firstly, to understand the spatial representativeness of CassavaMap, rather than considering the point predictions as an explanatory variable, the extracted aggregated summaries for predicted cassava production density, were each considered in turn. The form of the regression model was constrained to one of four types, 1) a linear relationship, 2) a logarithmic relationship, 3) a quadratic relationship and 4) a non-parametric spline. Secondly, a measure of population density was included (in addition to the measure of predicted cassava) through one of the extracted aggregated summaries as listed in Supplementary Table 1. The population density variable was constrained to one of four relationships in the model, 1) linear, 2) logarithmic 3) independent non-parametric spline or 4) dependent 2-d non-parametric spline with predicted cassava. Thirdly, a measure of settlement density was included (in addition to the measure of predicted cassava) through one of the extracted aggregated summaries as listed in Supplementary Table 1. The settlement density variable was constrained to one of four relationships in the model, 1) linear, 2) logarithmic 3) independent non-parametric spline or 4) dependent 2-d non-parametric spline with predicted cassava. Finally, we considered including measures of both population and settlement density in the model through the relationships described above and an additional 2-d non-parametric spline over both variables.

**SpatialTrends.R** contains the code investingating the geographical trends in the survey data. 
These were summarised by i) linear models accounting for administrative regions and ii) generalized additive models along the different transects of the sampling. For both countries, the total cassava area was first log-transformed and separate additive terms were fitted over longitude and latitude independently. There was insufficient data to fit an interaction between the two. Geographical trends in the CassavaMap predictions are summarised through generalized additive models (GAMs) using the dissolved buffer extraction of the spatial maps of the survey locations to investigate large-scale regional changes. Models were fitted to the natural logarithm of the prediction production with additive smooth terms for longitude and latitude.
